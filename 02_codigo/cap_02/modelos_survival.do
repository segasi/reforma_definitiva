//////////////////////////////////////////////////////////////////////////////////////////////// HEADER////////////////////////////////////////////////////////////////////////////////////////////////////////// FILE NAME: Garrido - SP09 Survival Models 080112/// DESC: Weibull models to analyze the effect of economic performance on /// the survival of single-party regimes (SPR). /// I'm using a databse previously merged in R called sp09.dta////////////////////////////////////////////////////////////////////////////////////////////// CODE /////////////////////////////////////////////////////////////////////////////////////////////////////////use "/Users/segasi 1/Google/R/01 investigacion/reforma_definitiva/03_datos_generados/sp.dta", clear
///////////////////// Chunk 1:Setting data as survival data///////////////// Every time we 'stset' the data, stata adds four variables to the /// dataset.  _t0 and _t record the time span the observation /// lived, with t units for each observation. _d records the outcome at the /// end of that span, 1 if the span ends in failure, 0 ///otherwise.  Finally, _st records whether the observation is relevant, /// that is, can be included in the study. stset gwf_duration, failure( gwf_fail==1) id(gwf_casename)/// NOTE: Given the longitudinal nature of the data analyzed, where each /// regime has multilpe observations (time varying covariates), id() tells Stata which variable/// to avoid treating each observation as distinct./// On the other hand, failure() defines the variable and value that is an event (i.e., regime failure)/// for the analysis. //// Brief description of the data just stset /stdes////////////// Chunk 3: Non-Parametric Analysis//////////////// Kaplan-Meier graph of the survivor function s(t) of sp09, without any/// control variables sts graph/// Kaplan-Meier graph of SPR by type of SPR, without any control variables /sts graph, by (gwf_regimetype)/// Raw data used to graph the previous Kaplan-Meier graphs  ///sts list///////////////////// Chunk 4: Models//////////////           ///////////////// NOTE: If 'nohr' is included at the end of the command Stata reports/// coefficients, not hazard ratios.  If 'time' is included at the end of /// the command Stata reports the Accelerated Failure Time (AFT). If 'tr'  /// is included at the end of the command Stata reports the Accelerated /// Failure Time (AFT) ratio, which is the same as exp(coeff) of the ATF.//// Model 1 Failure ~ Change in GDP per capita * Con pwt7streg pwt7_rgdpchl1,  dist(weib) cl(gwf_country)estimates store m1_pwt, title(Model 1pwt)* Con madstreg mad_gdppcl1,  dist(weib) cl(gwf_country)estimates store m1_mad, title(Model 1mad)//// Model 2 Failure ~ Five-Years Mov. Avg. * Con pwt7streg pwt7_fiveyma, dist(weib) cl(gwf_country)estimates store m2_pwt, title(Model 2pwt)* Con madstreg mad_fiveyma, dist(weib) cl(gwf_country)estimates store m2_mad, title(Model 2mad)//// Model 3 Failure ~ Deviation from Seven-Years Mov. Avg.* Con pwt7streg pwt7_devfiveyma, dist(weib) cl(gwf_country)estimates store m3_pwt, title(Model 3pwt)* Con madstreg mad_devfiveyma, dist(weib) cl(gwf_country)estimates store m3_mad, title(Model 3mad)//// Model 4 Failure ~ Change in GDP per capita + GDP per capita + //          + Oil Income per capita + Foreign Imposed// * Con pwt7streg pwt7_rgdpch_chl1 pwt7_rgdpchl1_log ross_preciol1_log fimposed, dist(weib) cl(gwf_country)estimates store m4_pwt, title(Model 4pwt)* Con mad
streg mad_gdppcl1_log mad_gdppcl1 ross_preciol1_log fimposed, dist(weib) cl(gwf_country)estimates store m4_pwt, title(Model 4pwt)
//// Model 5  Failure ~ Five-Years Mov. Avg. + GDP per capita //          + Oil Income per capita + Foreign Imposed//* Con pwt7streg pwt7_fiveyma pwt7_rgdpchl1 ross_preciol1_log fimposed, dist(weib) cl(gwf_country)estimates store m5_pwt, title(Model 5pwt)* Con mad
streg mad_fiveyma mad_gdppcl1 ross_preciol1_log fimposed, dist(weib) cl(gwf_country)estimates store m5_pwt, title(Model 5pwt)//// Model 6 Failure ~ Deviation from Seven-Years Mov. Avg. + GDP per capita //          + Oil Income per capita + Foreign Imposed//streg pwt7_devfiveyma pwt7_rgdpchl1_log ross_preciol1_log fimposed, dist(weib) cl(gwf_country)estimates store m6w, title(Model 6w) //// Model 7 Failure ~ Change in GDP per capita + GDP per capita //          + Oil Income per capita + Foreign Imposed + Regime type + Regions// streg pwt7_rgdpchl1 pwt7_rgdpchl1_log ross_preciol1_log fimposed gwf_party ///gwf_partymil gwf_partymilper gwf_casia gwf_easia gwf_ceeurope ///gwf_nafrica gwf_ssafrica gwf_samerica gwf_cacar, dist(weib) cl(gwf_country)estimates store m7w, title(Model 7w)//// Model 8 Failure ~ Five-Years Mov. Avg. + GDP per capita //          + Oil Income per capita + Foreign Imposed + Regime type + Regions//streg pwt7_fiveyma pwt7_rgdpchl1_log ross_preciol1_log fimposed gwf_party ///gwf_partymil gwf_partymilper gwf_casia gwf_easia gwf_ceeurope  ///gwf_nafrica gwf_ssafrica gwf_samerica gwf_cacar, dist(weib) cl(gwf_country) estimates store m8w, title(Model 8w)/* Accelerated failure time version of Model 8 */ streg pwt7_fiveyma pwt7_rgdpchl1_log ross_preciol1_log fimposed gwf_party ///gwf_partymil gwf_partymilper gwf_casia gwf_easia gwf_ceeurope  ///gwf_nafrica gwf_ssafrica gwf_samerica gwf_cacar, dist(weib) cl(gwf_country) time//// Model 9 Failure ~ Deviation from Seven-Years Mov. Avg. + GDP per capita //          + Oil Income per capita + Foreign Imposed + Regime type + Regions//streg pwt7_devfiveyma pwt7_rgdpchl1_log ross_preciol1_log fimposed gwf_party ///gwf_partymil gwf_partymilper gwf_casia gwf_easia gwf_ceeurope ///gwf_nafrica gwf_ssafrica gwf_samerica gwf_cacar, dist(weib)  cl(gwf_country)estimates store m9w, title(Model 9w)///////////////////// Chunk 4: Statistics of all models //////////////estimates stats _all